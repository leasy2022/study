private void exportErrorSql(String sql, boolean isHardError ) {
		if(sql == null || sql.length() < 1 ) {
			return;
		}
		sql += ";\n";
		String sqlExportPath = this.sqlExportPath;
		if (sqlExportPath == null) {
			sqlExportPath = ".";
		} else if (!sqlExportPath.endsWith(File.separator)) {
			sqlExportPath += File.separatorChar;
		}
		if (isHardError) {
			sqlExportPath += "hard";
		} else {
			sqlExportPath += "soft";
		}
		String parentDirPath = getParentDirPath(sqlExportPath, (int)System.currentTimeMillis()/1000);
		if (parentDirPath == null)
			return;
		String filePath = parentDirPath + "failed" + ".sql";
		OutputStream out = this.exportOutputStreamManager.get(filePath);
		// completed successfully, continue with ++filePart if failed.
		if(out != null) {
			try {
				out.write(sql.getBytes("UTF-8"));
			} catch (IOException e) {
				logger.error("IO exception to write to " + filePath, e);
			} finally {
				if(filePath != null ) {
					// close last output if output file changed
					this.exportOutputStreamManager.release(filePath, out);
				}
			}
		} else {
			logger.error("error to get output: {}", filePath);
		}
	}